mod ai_test {
  // GXL-AIåŸç”ŸéªŒè¯å·¥ä½œæµ - æœ€å°åŒ–å®ç°
  // éªŒè¯ç›®æ ‡ï¼šè¯æ˜GXLå¯ä»¥ç›´æ¥ä¸AIå¤§æ¨¡å‹äº¤äº’ï¼Œç”Ÿæˆæœ‰æ•ˆGit Commit

  env config {
    api_model = "gpt-4o"
    max_tokens = 150
    timeout = 10
  }

  // âœ… ç¬¬1å¤©éªŒè¯ï¼šAIåŸºç¡€è¿æ¥
  flow test_ai_connection : config {
    setup_message = "GXL-AIåŸç”ŸéªŒè¯æµ‹è¯• - å½“å‰å·²è¿æ¥å¤§æ¨¡å‹"

    # ä½¿ç”¨GXLçš„shellé›†æˆç›´æ¥ä¸AIé€šä¿¡
    ai_response = gx.shell( )
+
+    if [ -n "${ai_response}" ]; then
+      mx.echo "ğŸ¯ AIè¿æ¥æˆåŠŸï¼š${ai_response}"
+    else
+      mx.echo "âŒ AIè¿æ¥å¼‚å¸¸ï¼Œæ£€æŸ¥APIå¯†é’¥"
+    fi
+  }
+
+  # âœ… ç¬¬2å¤©éªŒè¯ï¼šGit+AIé›†æˆ
+  flow test_git_ai_integration : config {
+    # GXLç›´æ¥è¯»å–Gitå˜æ›´ï¼ˆæ— ä¸­é—´å±‚ï¼‰
+    changes = gx.pipe("git diff --cached 2>/dev/null || echo 'no-staged-changes'")
+
+    if [ "${changes}" = "no-staged-changes" ]; then
+      mx.echo "ğŸ’¡ æ‰§è¡Œ: git add example_test_file.txt æ¥åˆ›å»ºæµ‹è¯•å˜æ›´"
+      return
+    fi
+
+    # AIç›´æ¥ç†è§£å˜æ›´æ„å›¾
+    git_commit_suggestion = gx.pipe('''
+      cat <<EOF | curl -s -X POST "https://api.openai.com/v1/chat/completions" \
+        -H "Authorization: Bearer $OPENAI_API_KEY" \
+        -H "Content-Type: application/json" \
+        -d @-
+        {
+          "model": "gpt-4o",
+          "messages": [
+            {"role": "system", "content": "ç”¨50å­—ä»¥å†…ä¸­æ–‡æ€»ç»“ä»£ç å˜æ›´ï¼ŒæŒ‰Conventional Commitsæ ¼å¼"},
+            {"role": "user", "content": "'"${changes}"'"}
+          ],
+          "max_tokens": 50
+        }
+      EOF | jq -r '.choices[0].message.content'
+    ''')
+
+    mx.echo "ğŸš€ AIåˆ†æç»“æœ: ${git_commit_suggestion}"
+
+    # GXLä¸AIååŒå†³ç­–
+    should_commit = gx.confirm(
+      prompt: "ä½¿ç”¨AIå»ºè®®çš„æäº¤ä¿¡æ¯: ${git_commit_suggestion}? (y/n)",
+      accept_key: "y",
+      reject_key: "n"
+    )
+
+    if [ "${should_commit}" = "y" ]; then
+      git.commit(message: "${git_commit_suggestion}")
+      mx.echo "âœ… AIæ™ºèƒ½æäº¤å®Œæˆï¼"
+    else
+      mx.echo "â¸ï¸ å–æ¶ˆè‡ªåŠ¨æäº¤ï¼Œå¯æ‰‹åŠ¨ç¼–è¾‘"
+    fi
+  }
+}
